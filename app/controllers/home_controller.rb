require 'google_spreadsheet'
class HomeController < ApplicationController
  def mapcoord
    send_file("#{Rails.root}/public/images/pointy.gif",{
        :filename => "tile.gif",
        :disposition => 'inline'
      })
  end
  def index
    keys = YAML::load(ERB.new(File.read("#{Rails.root}/config/gdata.yml")).result).stringify_keys
    session = GoogleSpreadsheet.login(keys[Rails.env]["email"], keys[Rails.env]["password"])
    key = '0AhodtM_0InjodENhamhKbEZvLVVqQllwaHhTdlZLRlE'
    
    @map = Map.new(session.spreadsheet_by_key(key).worksheets[0]).get_table
 #   logger.info @map

=begin
    @map = [{"map"=>"asia", "place"=>"Akka, Ottoman Palistine", "lat"=>"32.55", "long"=>"35.06", "title"=>"Boarded ship for Europe", "description"=>"Beginning the first journey to the West.", "date"=>"11/8/1911"}, {"map"=>"europe", "place"=>"Marseilles, France", "lat"=>"43.17", "long"=>"5.22", "title"=>"Arrives in France", "description"=>"Departs the S.S. Corsica. Will now travel overland.", "date"=>""}, {"map"=>"europe", "place"=>"Thonon-les-Bains, France", "lat"=>"46.22", "long"=>"6.28", "title"=>"rest in the Alps", "description"=>"Restings at Lake Geniva", "date"=>"29/8/1911"}, {"map"=>"europe", "place"=>"London, England", "lat"=>"51.3", "long"=>"0.07", "title"=>"Arrives in London", "description"=>"Resides at the home of Lady Blomfield. Visits the Lord Mayor of London.", "date"=>"4/9/1911"}, {"map"=>"europe", "place"=>"London, England", "lat"=>"51.3", "long"=>"0.07", "title"=>"Unit Feast", "description"=>"Meets with friends in the home of Miss Ethel Rosenberg.", "date"=>"8/9/1911"}, {"map"=>"europe", "place"=>"Byfleet, England", "lat"=>"51.2", "long"=>"0.28", "title"=>"Visit to Vanners", "description"=>"", "date"=>"9/9/1911"}, {"map"=>"europe", "place"=>"London, England", "lat"=>"51.3", "long"=>"0.07", "title"=>"City Temple", "description"=>"Gives first public address", "date"=>"10/9/1911"}, {"map"=>"europe", "place"=>"London, England", "lat"=>"51.3", "long"=>"0.07", "title"=>"talk", "description"=>"Gives short discourse in the home of Mr.s Thornburgh-Cropper", "date"=>"13/9/1911"}, {"map"=>"europe", "place"=>"London, England", "lat"=>"51.3", "long"=>"0.07", "title"=>"St John the Divine Church", "description"=>"Give public talk", "date"=>"17/9/1911"}, {"map"=>"europe", "place"=>"London, England", "lat"=>"51.3", "long"=>"0.07", "title"=>"talk", "description"=>"Gives short discourse in the home of Mr.s Thornburgh-Cropper", "date"=>"23/9/1911"}, {"map"=>"europe", "place"=>"Bristol, England", "lat"=>"51.27", "long"=>"2.35", "title"=>"Bristol visit", "description"=>"Stays in the Clifton Guest House", "date"=>"23/9/1911"}, {"map"=>"europe", "place"=>"Byfleet, England", "lat"=>"51.2", "long"=>"0.28", "title"=>"Second Visit to Vanners", "description"=>"Visits the Brooklands aviation grounds", "date"=>"28/9/1911"}, {"map"=>"europe", "place"=>"London, England", "lat"=>"51.3", "long"=>"0.07", "title"=>"Passmore Edward's Settlement", "description"=>"Farewell gathering hosted by Mrs. Thornburgh-Cropper", "date"=>"29/9/1911"}, {"map"=>"europe", "place"=>"London, England", "lat"=>"51.3", "long"=>"0.07", "title"=>"Theosophical Headquarters", "description"=>"Gives short discourse  ", "date"=>"30/9/1911"}, {"map"=>"europe", "place"=>"London, England", "lat"=>"51.3", "long"=>"0.07", "title"=>"Marriage of Regina Nur Mahal Khanum and Mirza Yuhanna Dawud", "description"=>"\"Never have I united anyone in marriage before, except my own daughters.\" Remark made by the Master, who presided over the wedding.", "date"=>"1/10/1911"}, {"map"=>"europe", "place"=>"Paris, France", "lat"=>"48.51", "long"=>"2.21", "title"=>"Arrives in Paris", "description"=>"Resides at 4 Avenue de Camoen for nine weeks. His morning coversations here were recorded in the book Paris Talks.", "date"=>"3/10/1911"}, {"map"=>"europe", "place"=>"Paris, France", "lat"=>"48.51", "long"=>"2.21", "title"=>"L'Alliance Spiritualiste", "description"=>"Gives short discourse", "date"=>"9/11/1911"}, {"map"=>"europe", "place"=>"Paris, France", "lat"=>"48.51", "long"=>"2.21", "title"=>"15 Rue Greuze", "description"=>"Gives short discourse", "date"=>"10/11/1911"}, {"map"=>"europe", "place"=>"Paris, France", "lat"=>"48.51", "long"=>"2.21", "title"=>"Pastor Wagner's Church", "description"=>"Give talk recorded in Paris Talks", "date"=>"26/11/1911"}, {"map"=>"europe", "place"=>"Paris, France", "lat"=>"48.51", "long"=>"2.21", "title"=>"15 Rue Greuze", "description"=>"Gives short discourse", "date"=>"1/12/1911"}, {"map"=>"europe", "place"=>"Paris, France", "lat"=>"48.51", "long"=>"2.21", "title"=>"Departs for Egypt", "description"=>"Will winter in Alexandria", "date"=>"2/12/1911"}, {"map"=>"africa", "place"=>"Alexandria, Egypt", "lat"=>"31.12", "long"=>"29.56", "title"=>"Arrives in Egypt", "description"=>"Winter residence", "date"=>""}]
=end
  end



end
